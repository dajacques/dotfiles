tmux list-sessions -F "#S" | grep -q "^$1$"
if [ $? -ne 0 ]
then
  tmux new-session -s $1 -n terminal -d
  tmux send-keys -t $1:1 "cd $2" C-m
  tmux send-keys -t $1:1 "clear" C-m
  tmux new-window -t $1:2 -n vim
  tmux send-keys -t $1:2 "cd $2" C-m
  tmux send-keys -t $1:2 "vim" C-m
  tmux select-window -t $1:1

  if [ -f $2/Guardfile ]
  then
    tmux new-window -t $1:3 -n guard -d
    tmux send-keys -t $1:3 "cd $2" C-m
    tmux send-keys -t $1:3 "bundle exec guard" C-m
    tmux set-window-option -t $1:3 -g automatic-rename off
    tmux set-window-option -t $1:3 -g allow-rename off
    tmux rename-window -t $1:3 guard
  fi
fi
tmux attach-session -t $1
